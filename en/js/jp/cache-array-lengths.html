<p>ループは確実にJavaScriptのパフォーマンスに関する最も重要な部分の1つです。反復処理が効果的に行われるようにループの内部のロジックを最適化しましょう。</p>
<p>1つの手段は、包まれる配列のサイズを保持しておくことで、それによってループが繰り返される度に再度計算する必要がなくなります。</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000</span>),
    len, i;

<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
  <span class="hljs-comment">// 良くない - サイズは1000回計算される必要があります</span>
}

<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = arr.length; i &lt; len; i++) {
  <span class="hljs-comment">// 良い - サイズは1度だけ計算されて保持されます</span>
}
</code></pre>
<p><em><a href="http://jsperf.com/browser-diet-cache-array-length/10/">&gt; JSPerfの結果</a></em></p>
<p><strong>&gt; 注:</strong> <em>モダンブラウザのエンジンは自動的にこのプロセスを最適化しますが、未だに残るレガシーブラウザ向けの良いプラクティスとして残しています。</em></p>
<p>例えば<code>document.getElementsByTagName(&#39;a&#39;)</code>によって生成されたNode（<em>NodeList</em>）のリストのようなHTMLの集合に対する反復処理の場合に、これはとりわけ重要です。これらの集合は&quot;生きている&quot;と見なされます。即ち、それらはその属する要素の変化に応じて自動的に更新されるのです。</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-keyword">var</span> links = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'a'</span>),
    len, i;

<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; links.length; i++) {
  <span class="hljs-comment">// 良くない - リンクのリストに変化があるかを確認するため反復処理毎に再計算されます</span>
}

<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = links.length; i &lt; len; i++) {
  <span class="hljs-comment">// 良い - リストのサイズを最初に取得して保存し、反復毎に比較します</span>
}

<span class="hljs-comment">// 恐ろしい: 無限ループの例</span>
<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; links.length; i++) {
  <span class="hljs-built_in">document</span>.body.appendChild(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'a'</span>));
  <span class="hljs-comment">// リンクのリストが増加する反復処理毎に、ループの終了条件が満たされることがありません</span>
  <span class="hljs-comment">// リストのサイズが保持され条件として使われる場合には起きないことです</span>
}
</code></pre>
<p><em>&gt; <a href="https://github.com/zenorocha/browser-diet/wiki/References#cache-array-lengths">リファレンス</a></em></p>
